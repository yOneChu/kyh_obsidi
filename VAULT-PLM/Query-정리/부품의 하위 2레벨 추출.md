---
tags:
  - PLM
---

---

```
SELECT
		 	TO_CHAR(LEVEL) AS P_LEVEL,
            'partofpart$ac@' || lower(dectohex(BOM.SF$OUID)) AS OOID,
            NP.MD$NUMBER
		 	-- , TO_CHAR(BOM.AS$END1) AS$END1
		 	-- , TO_CHAR(BOM.AS$END2) AS$END2
		 	, BOM.QTY
		 	, BOM.CMT
		 	, BOM.PART_SPT
		 	, CODN(NP.NATION)
		 	, NP.COMPEN_PART
		 	, DECODE(BOM.SERVICEFLAG, 'T', BOM.SERVICEFLAG, NULL)
		 	, BOM.MD$SEQUENCE
		 	, CODN(NP.UOM) UOM -- 단위
		 	, CODN(NP.CLASSIFICATION_01)
		 	, BLOCKNO_NUMBER
		 	, NP.MD$DESC
		 --	, NP.MD$NUMBER
		 	, NP.VF$VERSION -- \"version\"
		 	, NP.G_L_CODE  -- \"g_l_code\"
		 	, NP.PART_SIZE
		 	, NP.SPEC
		 	, CODN(NP.SPT)
		 	, CODN(NP.ORIGIN_DIV) -- 내작외작
		 	, CODN(NP.REVISION)
		 	, CODN(NP.PART_STATUS)
		 	, CODN(NP.ACTIVE_YN)
		 	, NP.MD$STATUS
            , DATEFORMAT(BOM.MD$CDATE, 'YYYYMMDDHH24MISS', 'YYYY-MM-DD HH24:MI:SS') AS CREATE_DATE
		 	, DATEFORMAT(BOM.MD$MDATE, 'YYYYMMDDHH24MISS', 'YYYY-MM-DD HH24:MI:SS') AS UPDATE_DATE
		 	, DECODE(B1.MD$NUMBER, NULL, NULL, B1.MD$NUMBER || ' ' || B1.MD$DESC)
		 	, DECODE(B2.MD$NUMBER, NULL, NULL, B2.MD$NUMBER || ' ' || B2.MD$DESC)
		 	, DECODE(CAD.MD$NUMBER, NULL, NULL, CAD.MD$NUMBER || ' ' || CAD.MD$DESC)
		 	, DECODE(NAME.MD$NUMBER, NULL, NULL, NAME.MD$NUMBER || ' ' || NAME.MD$DESC)
		 	, U.MD$DESC
		 	, U2.MD$DESC
		 FROM
		 	PARTOFPART$AC BOM
         INNER JOIN NORMALPART$VF NP ON 	BOM.AS$END2 = NP.VF$OUID
		 LEFT OUTER JOIN BLOCKNO$SF B1 ON B1.SF$OUID = GETID(NP.BLOCKNO)
		 LEFT OUTER JOIN BLOCKNO$SF B2 ON B2.SF$OUID = GETID(NP.UPPERBLOCKNO)
		 LEFT OUTER JOIN AUTOCAD_FILE$VF CAD ON CAD.VF$OUID = GETID(NP.DRAWING_NO)
		 LEFT OUTER JOIN FUSER$SF U ON U.MD$NUMBER = BOM.CUSER
		 LEFT OUTER JOIN FUSER$SF U2 ON U2.MD$NUMBER = NP.MD$USER
		 LEFT OUTER JOIN PARTNAME$SF NAME ON NAME.SF$OUID = GETID(NP.PARTNAME)
		 START WITH AS$END1 = '2824607936' -- 부품OID(VF$OUID)
		 CONNECT BY
		 	PRIOR AS$END2 = AS$END1
		 	ORDER SIBLINGS BY CAST(BOM.MD$SEQUENCE AS NUMBER DEFAULT 0 ON CONVERSION ERROR)
```



**| 부품의 2레벨 (최근)**
```
SELECT  
          (ROWNUM-1) idx,  
          (LEVEL+1)  LEV,  
          A.SF$OUID ASSOOUID,  
          A.AS$END1 END1,  
          A.AS$END2 END2,  
          A.END1_HEXOUID END1HEX,  
          A.END2_HEXOUID END2HEX,  
          A.MD$SEQUENCE SEQ,  
          (SELECT MD$NUMBER FROM NORMALPART$VF WHERE VF$OUID = A.AS$END1) PARENTNO,  
          (SELECT NVL(COD(ORIGIN_DIV), '') FROM NORMALPART$VF WHERE VF$OUID = A.AS$END1) PARENTDIV,  
          (SELECT COUNT(*) FROM PARTANDCAD$AS WHERE AS$END1 = A.AS$END2) CADCNT,  
          NP.MD$NUMBER PARTNO,  
          NP.MD$DESC PARTNAME,  
          NP.VF$VERSION VERSION,  
          NVL(NP.G_L_CODE, '') GLCODE,  
          NVL(COD(NP.NATION), '') NATION,  
          A.QTY,  
          VP.WORK_QTY,  
          A.CMT,  
          VP.WORK_CMT,  
          A.COLOR,  
          VP.WORK_COLOR,  
          NVL(NP.COMPEN_PART, '') COMPEN_PART,  
          NVL(A.SERVICEFLAG, '') SERVICEFLAG,  
          NVL(NP.SPEC, '') SPEC,  
          NVL(NP.PART_SIZE, '') PART_SIZE,  
          (SELECT MD$NUMBER FROM BLOCKNO$SF WHERE SF$OUID =  DECODE(NP.BLOCKNO, NULL, NULL, HEXTODEC(UPPER(SUBSTR(NP.BLOCKNO, 12))))) BLOCKNO,  
          (SELECT NVL(LOSSRATE, '') FROM BLOCKNO$SF WHERE SF$OUID =  DECODE(NP.BLOCKNO, NULL, NULL, HEXTODEC(UPPER(SUBSTR(NP.BLOCKNO, 12))))) LOSSRATE,  
          (SELECT COD(BLOCK_OPT) FROM BLOCKNO$SF WHERE SF$OUID =  DECODE(NP.BLOCKNO, NULL, NULL, HEXTODEC(UPPER(SUBSTR(NP.BLOCKNO, 12))))) BLOCK_OPT,  
          (SELECT MD$NUMBER FROM BLOCKNO$SF WHERE SF$OUID =  DECODE(NP.UPPERBLOCKNO, NULL, NULL, HEXTODEC(UPPER(SUBSTR(NP.UPPERBLOCKNO, 12))))) UPPERBLOCKNO,  
          NVL(COD(NP.UOM), '') UOM,  
          NVL(CODN(NP.ORIGIN_DIV), '') DIV,  
          NVL(A.MBOM, '') MBOM,  
          NVL(COD(NP.PART_MBOM), '') PART_MBOM,  
             (SELECT MD$DESC FROM FUSER$SF WHERE MD$NUMBER = NP.MD$USER) USERNAME,  
          NP.MD$USER USERID,  
          NP.OLD_CODE,NP.OLD_CODE2, NP.OLD_CODE3, COD(NP.SPT) SPT, COD(NP.PARTMPCHECK) PARTMPCHECK,  
             (SELECT MD$DESC FROM FUSER$SF WHERE MD$NUMBER = B.CUSER) CUSERNAME, B.CUSER CUSERID,  
             NVL(A.PART_SPT, '') PART_SPT,  
          DECODE(CONNECT_BY_ISLEAF, 0,'F', 1, 'T') ISLEAF,  
             VP.UCHECK, VP.MCHECK, NVL(COD(NP.PART_DIVISION), '') PART_DIVISION, A.MD$CDATE CDATE, VP.MDATE,  
             VP.user5 --, VP.*  
          FROM PARTOFPART$AC A  
          INNER JOIN NORMALPART$VF NP ON AS$END2 = NP.VF$OUID  
          --LEFT OUTER JOIN VARIABLEPART_NEW VP ON A.SF$OUID = VP.ASSOOUID AND VP.PRODUCTOUID = '2868435124'  
           LEFT JOIN VARIABLEPART_NEW VP ON A.SF$OUID = VP.ASSOOUID AND VP.PRODUCTOUID = '2868435124'  
                LEFT OUTER JOIN PARTOFEBOM B ON B.PARTOUID = '2866753066' --END2  
            AND B.PRODUCTOUID = '2868435124'  
            --WHERE A.QTY IS NOT NULL OR (SUBSTR(A.QTY, 0, 1) = 'A' AND VP.WORK_QTY IS NOT NULL)  
            WHERE REGEXP_LIKE(A.QTY, '^[0-9]+$') OR A.QTY LIKE 'A%' AND NVL(VP.WORK_QTY, 0) <> 0  
            START WITH AS$END1 = '2866753066' -- END2  
          CONNECT BY PRIOR AS$END2 = AS$END1  
          ORDER SIBLINGS BY CAST(MD$SEQUENCE AS NUMBER DEFAULT 0 ON CONVERSION ERROR)
```